!function(){"use strict";function t(t){if(!t.querySelector(".receipt-body")){var e=document.createElement("div");e.className="receipt-body",t.appendChild(e),r(t,e)}}function e(){for(var e=0,a=[].slice.call(document.querySelectorAll("spaaza-receipt"),0);e<a.length;e++)t(a[e])}function a(t){var e=function(e){var a=t.querySelector("script[data-"+e+"]");if(a&&a.textContent)try{return JSON.parse(a.textContent)}catch(t){console.warn("Failed to parse "+e+" data: ",t)}},a=t.getAttribute("language")||"",r=p(a),n=e("strings"),i=n?h(r,n):r;return{langCode:r.langCode,receipt:e("receipt"),strings:i}}function r(t,e){var r,n=a(t);if(n.receipt){var i=o(n.receipt),s=m(n.strings,{$GIVEN_NAME:n.receipt.shopper.first_name,$FAMILY_NAME:n.receipt.shopper.last_name,$CHAIN_NAME:n.receipt.chain.name}),l=g(s,function(t){return v(t)});r=A(i,l,n.langCode)}else console.warn("Could not draw receipt",n),r=L({},n.strings.error,n.langCode);e.innerHTML="<style>"+H+'</style>\n<div class="spaaza-receipt">'+r+"</div>"}function n(){if("MutationObserver"in window){new MutationObserver(function(e){for(var a=0,r=e;a<r.length;a++)for(var n=r[a],i=0,s=Array.prototype.slice.call(n.addedNodes,0);i<s.length;i++){var o=s[i];o.nodeType===Node.ELEMENT_NODE&&"spaaza-receipt"===o.nodeName.toLowerCase()&&t(o)}}).observe(document,{childList:!0,subtree:!0})}}var i=function(t,e){return(t||[]).map(function(t){return t[e]}).reduce(function(t,e){return t+e},0)},s=function(t,e,a,r){return(t||[]).filter(function(t){return t[a]===r}).map(function(t){return t[e]}).reduce(function(t,e){return t+e},0)},o=function(t){var e=t.chain,a=e.currency_symbol,r=e.business;return{brand:{logoURL:e.logo_url},details:{name:e.id,id:t.id,retailerCode:t.retailer_basket_code,total:t.total_value,date:t.timestamp,currencySymbol:a},lineitems:{lineitems:t.line_items,currencySymbol:a},linetaxes:{linetaxes:t.tax_lines,currencySymbol:a},totals:{total:t.total_value,subtotal:t.subtotal,loyaltyVouchersSpent:s(t.basket_vouchers,"amount","type","loyalty"),walletVouchersSpent:s(t.basket_vouchers,"amount","type","wallet"),currencySymbol:a,basketVouchers:t.basket_vouchers},download:{downloadURL:t.download_url},wallet:{wallet:t.monetary_wallet,totalEarned:i(t.monetary_wallet.contributions,"amount"),totalSpent:s(t.basket_vouchers,"amount","type","wallet"),currencySymbol:a},pointswallet:{wallet:t.points_wallet||{},totalEarned:t.points_wallet&&i(t.points_wallet.contributions,"amount")||0,totalSpent:0,currencySymbol:"pts"},store:{name:r.name,contact:r.phone_number,email:r.email,website:r.website_url,address:(r.address.address_1+" "+r.address.address_2+" "+r.address.address_3).trim(),postalcode:r.address.postal_code,towncity:r.address.towncity},barcode:{retailerCode:t.retailer_basket_code||""}}},l={"en-GB":{langCode:"en-GB",brand:{title:"Your Receipt",message:"Hi there $GIVEN_NAME, thanks for your purchase!"},details:{message:"Your order details from $CHAIN_NAME:",charged:"CHARGED","order-number":"Order number",date:"Date"},lineitems:{name:"Name",quantity:"Qty",price:"Price"},linetaxes:{"tax-rate":"VAT Rate","order-value":"Order value","tax-value":"VAT"},totals:{subtotal:"Subtotal",total:"Total",voucher:"Voucher"},wallet:{earned:"earned",spent:"spent","new-balance":"Your new balance"},download:{label:"Download your PDF Receipt"},store:{message:"Thank you!"},error:{message:"There was a problem showing this receipt."}},"nl-NL":{langCode:"nl-NL",brand:{title:"Jouw Bon",message:"Bedankt voor je aankoop, $GIVEN_NAME!"},details:{message:"Informatie over je aankoop bij $CHAIN_NAME:",charged:"In rekening gebracht","order-number":"Bestellingsnummer",date:"Datum"},lineitems:{name:"Naam",quantity:"Aantal",price:"Prijs"},linetaxes:{"tax-rate":"BTW %","order-value":"Waarde","tax-value":"BTW"},totals:{subtotal:"Subtotaal",total:"Totaal",voucher:"Kortingsbon"},wallet:{earned:"verdiend",spent:"uitgegeven","new-balance":"Jouw nieuwe totaal"},download:{label:"Download je bon als PDF"},store:{message:"Hartelijk bedankt!"},error:{message:"Er was een probleem met het tonen van deze bon."}}},c=function(t){var e="en-GB";return"nl"!==(t=t.toLowerCase().trim())&&"nl-"!==t.substr(0,3)&&"nl_"!==t.substr(0,3)||(e="nl-NL"),e},p=function(t){return l[c(t)]},d=function(t,e){var a={};for(var r in t)t.hasOwnProperty(r)&&(a[r]=e(t[r],r));return a},u=function(t,e){var a={};for(var r in t)t.hasOwnProperty(r)&&"object"==typeof t[r]&&(a[r]=e(t[r],r));return a},g=function(t,e){return u(t,function(t,a){return d(t,e)})},b=function(t,e){var a=t;for(var r in e)e.hasOwnProperty(r)&&(a=a.replace(new RegExp(function(t){return t.replace(/[\-\[\]\{\}\(\)\*\+\?\.\\\^\$\|\#]/g,function(t){return"\\"+t})}(r),"g"),e[r]));return a},m=function(t,e){return g(t,function(t){return b(t,e)})},h=function(t,e){return u(t,function(t,a){var r=e[a];return d(t,function(t,e){return r&&e in r?r[e]:t})})},f=function(t,e){var a="pts"===e,r=a?0:2,n=!a,i=(+t).toFixed(r);return n?e+" "+i:i+" "+e},v=function(t){return(t||"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/%u/g,"&#x")},w='\n<table class="divider-wrapper">\n\t<tr>\n\t\t<td class="divider-spacer">\n\t\t<table class="divider" cellpadding="0" cellspacing="0">\n\t\t\t<tr><td></td></tr>\n\t\t</table>\n\t\t</td>\n\t</tr>\n</table>\n',z=function(t,e,a){var r="<table>";return t.logoURL&&(r+='\n\t\t\t<tr>\n\t\t\t\t<td><img class="brand_logo" src="'+v(t.logoURL)+'"></td>\n\t\t\t</tr>\n\t\t'),e.title&&(r+="\n\t\t\t<tr>\n\t\t\t\t<td><h1>"+e.title+"</h1></td>\n\t\t\t</tr>\n\t\t"),e.message&&(r+="\n\t\t\t<tr>\n\t\t\t\t<td><p>"+e.message+"</p></td>\n\t\t\t</tr>\n\t\t"),r+="</table>"},y=function(t,e,a){var r="<table>";return e.message&&(r+='<tr><td colspan="2">'+e.message+"</td></tr>"),t.total&&(r+='\n\t\t\t<tr class="receipt-strong">\n\t\t\t\t<td class="">'+e.charged+'</td>\n\t\t\t\t<td class="align-right">'+f(t.total,t.currencySymbol)+"</td>\n\t\t\t</tr>\n\t\t"),t.retailerCode&&(r+='\n\t\t\t<tr>\n\t\t\t\t<td class="">'+e["order-number"]+'</td>\n\t\t\t\t<td class="align-right">#'+v(t.retailerCode)+"</td>\n\t\t\t</tr>\n\t\t"),t.date&&(r+='\n\t\t\t<tr>\n\t\t\t\t<td class="">'+e.date+'</td>\n\t\t\t\t<td class="align-right">'+v(new Date(t.date).toLocaleString(a))+"</td>\n\t\t\t</tr>\n\t\t"),r+="</table>"},x=function(t,e,a){if(!t.lineitems||!t.lineitems.length)return"";var r=t.currencySymbol,n="";n+=w,n+='\n\t\t<table class="receipt-lineitems">\n\t\t\t<tr>\n\t\t\t\t<th class="align-left">'+e.name+'</th>\n\t\t\t\t<th class="align-center">'+e.quantity+'</th>\n\t\t\t\t<th class="align-right">'+e.price+"</th>\n\t\t\t</tr>\n\t";for(var i=0,s=t.lineitems;i<s.length;i++){var o=s[i],l=o.original_price>o.sale_price;n+='\n\t\t\t<tr class="line-item">\n\t\t\t\t<td class="align-left">\n\t\t\t\t\t<div class="line-item-name">'+v(o.name||o.barcode)+'</div>\n\t\t\t\t</td>\n\t\t\t\t<td class="align-center">'+v(o.quantity)+'</td>\n\t\t\t\t<td class="align-right">\n\t\t\t\t\t<span class="receipt-original-price '+(l?"receipt-line-through":"")+'">'+f(o.original_price,r)+'</span>\n\t\t\t\t\t<span class="receipt-sale-price receipt-strong">'+f(o.sale_price,r)+"</span>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t"}return n+="</table>"},_=function(t,e,a){if(!t.linetaxes||!t.linetaxes.length)return"";var r=t.currencySymbol,n="";n+=w,n+='\n\t\t<table class="receipt-linetaxes">\n\t\t\t<tr>\n\t\t\t\t<th class="align-left">'+e["tax-rate"]+'</th>\n\t\t\t\t<th class="align-center">'+e["order-value"]+'</th>\n\t\t\t\t<th class="align-right">'+e["tax-value"]+"</th>\n\t\t\t</tr>\n\t";for(var i=0,s=t.linetaxes;i<s.length;i++){var o=s[i];n+='\n\t\t\t<tr class="tax-line">\n\t\t\t\t<td class="var-rate align-left">'+v(o.rate)+'%</td>\n\t\t\t\t<td class="order-value align-center">'+f(o.order_value,r)+'</td>\n\t\t\t\t<td class="vat align-right">'+f(o.tax_value,r)+"</td>\n\t\t\t</tr>\n\t\t"}return n+="</table>"},k=function(t,e,a){var r=t.basketVouchers,n="";if(n+=w,n+='<table class="receipt-totals">',r&&r.length>0)for(var i=0,s=r;i<s.length;i++){var o=s[i];n+="\n\t\t\t\t<tr>\n\t\t\t\t\t<td>"+e.voucher+": "+v(o.campaign_title)+'</td>\n\t\t\t\t\t<td align="right" class="voucher">('+f(o.amount,t.currencySymbol)+")</td>\n\t\t\t\t</tr>\n\t\t\t"}return n+='\n\t\t<tr class="receipt-subtotal">\n\t\t\t<td>'+e.subtotal+'</td>\n\t\t\t<td class="align-right">'+f(t.subtotal,t.currencySymbol)+"</td>\n\t\t</tr>\n\t",n+='\n\t\t<tr class="receipt-strong">\n\t\t\t<td>'+e.total+'</td>\n\t\t\t<td class="align-right">'+f(t.total,t.currencySymbol)+"</td>\n\t\t</tr>\n\t",n+="</table>"},C=function(t,e,a){var r=t.wallet,n=t.totalEarned,i=t.totalSpent,s=t.currencySymbol;if(!n&&!i)return"";var o="";if(o+=w,o+='<table class="receipt-wallet">',o+='<tr><td class="receipt-strong">'+v(r.title)+"</td></tr>",n&&(o+="\n\t\t\t<tr>\n\t\t\t\t<td>"+v(r.title)+" "+e.earned+'</td>\n\t\t\t\t<td align="right">'+f(n,s)+"</td>\n\t\t\t</tr>\n\t\t",r.contributions.length>1))for(var l=0,c=r.contributions;l<c.length;l++){var p=c[l];o+="\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>&nbsp;&nbsp;&nbsp;&nbsp;"+v(p.campaign_title)+'</td>\n\t\t\t\t\t\t<td align="right">'+f(p.amount,s)+"</td>\n\t\t\t\t\t</tr>\n\t\t\t\t"}return i&&(o+="\n\t\t\t<tr>\n\t\t\t\t<td>"+v(r.title)+" "+e.spent+'</td>\n\t\t\t\t<td align="right">'+f(i,s)+"</td>\n\t\t\t</tr>\n\t\t"),o+='\n\t\t<tr class="receipt-total">\n\t\t\t<td>'+e["new-balance"]+'</td>\n\t\t\t<td align="right" class="receipt-strong">'+f(r.total,s)+"</td>\n\t\t</tr>\n\t",o+="</table>"},E=function(t,e,a){var r="";return t.downloadURL&&(r+=w,r+='<div class="btn-download"><a href="'+v(t.downloadURL)+'" target="_blank">'+e.label+"</a><div>"),r},N=function(t,e,a){if(!(t.name||t.message||t.address||t.contact||t.email||t.website||t.towncity||t.postalcode))return"";var r="";return r+=w,r+='<table class="receipt-store">',r+='\n\t\t<tr>\n\t\t\t<td class="align-left">\n\t',t.name&&(r+="<div>"+v(t.name)+"</div>"),t.address&&(r+="<div>"+v(t.address)+"</div>"),t.towncity&&t.postalcode?r+="<div>"+v(t.towncity)+", "+v(t.postalcode)+"</div>":t.towncity&&!t.postalcode?r+="<div>"+v(t.towncity)+"</div>":!t.towncity&&t.postalcode&&(r+="<div>"+v(t.postalcode)+"</div>"),t.email&&(r+='<div><a href="mailto:'+v(t.email)+'">'+v(t.email)+"</a></div>"),t.website&&(r+='<div><a href="'+v(t.website)+'" target="_blank">'+v(t.website)+"</a></div>"),t.contact&&(r+='<a href="tel:'+v(t.contact)+'">'+v(t.contact)+"</a>"),r+="\n\t\t\t</td>\n\t\t</tr>\n\t",r+="</table>",e.message&&(r+=w,r+='<p class="receipt-emphasys receipt-footer-message">'+e.message+"</p>"),r},S=function(t,e,a){return t.retailerCode?'\n\t\t<div class="content barcode">\n\t\t\t<div class="image" title="Barcode: '+t.retailerCode+'" style="background-image: url(https://missetam.spaaza.com/barcode/'+t.retailerCode+')"></div>\n\t\t</div>\n\t':""},A=function(t,e,a){var r={header:["brand","details"],content:["lineitems","linetaxes","totals","wallet","pointswallet","download"],footer:["store","barcode"]},n={brand:z,details:y,lineitems:x,linetaxes:_,totals:k,wallet:C,download:E,store:N,barcode:S},i='<div class="main content">';for(var s in r){i+="<section>";for(var o=0,l=r[s];o<l.length;o++){var c=l[o],p="pointswallet"===c?n.wallet:n[c],d="pointswallet"===c?e.wallet:e[c];i+=p(t[c],d,a)}i+="</section>"}return i+="</div>"},L=function(t,e,a){return'\n\t\t<div class="main content">\n\t\t\t<p>'+e.message+"</p>\n\t\t</div>\n\t"},H='.spaaza-receipt a,.spaaza-receipt div,.spaaza-receipt table,.spaaza-receipt td{box-sizing:border-box}.spaaza-receipt img{-ms-interpolation-mode:bicubic;max-width:100%}.spaaza-receipt table{border-collapse:separate!important;width:100%}.spaaza-receipt table td,.spaaza-receipt table th{font-family:"Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-size:14px;vertical-align:top}.spaaza-receipt table th{font-size:12px;text-transform:uppercase;font-weight:400;color:#aaa}.spaaza-receipt .ExternalClass{width:100%}.spaaza-receipt .ExternalClass,.spaaza-receipt .ExternalClass div,.spaaza-receipt .ExternalClass font,.spaaza-receipt .ExternalClass p,.spaaza-receipt .ExternalClass span,.spaaza-receipt .ExternalClass td{line-height:100%}.spaaza-receipt body{background-color:#f6f6f6}.spaaza-receipt .body{background-color:#f6f6f6;width:100%}.spaaza-receipt .container{display:block;Margin:0 auto!important;max-width:580px;padding:10px;width:auto!important;width:580px}.spaaza-receipt .content{display:block;margin:0 auto;max-width:580px;padding:10px}.spaaza-receipt .main{background:#fff;border:1px solid #e9e9e9;border-radius:3px;width:100%;padding:2em}.spaaza-receipt .wrapper{padding:30px}.spaaza-receipt .content-block{padding:0 0 30px}.spaaza-receipt .header{margin-bottom:30px;margin-top:20px;width:100%}.spaaza-receipt .footer{clear:both;width:100%}.spaaza-receipt .footer *{color:#999;font-size:12px}.spaaza-receipt .footer td{padding:20px 0}.spaaza-receipt h1,.spaaza-receipt h2,.spaaza-receipt h3,.spaaza-receipt h4{color:#111!important;font-family:"Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-weight:400;line-height:1.4em;margin:0;margin-bottom:30px}.spaaza-receipt h1{font-size:38px;text-transform:capitalize;font-weight:300}.spaaza-receipt h2{font-size:24px}.spaaza-receipt h3{font-size:18px}.spaaza-receipt h4{font-size:14px;font-weight:500}.spaaza-receipt ol,.spaaza-receipt p,.spaaza-receipt ul{font-family:"Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-size:14px;font-weight:400;margin:0;margin-bottom:15px}.spaaza-receipt ol li,.spaaza-receipt p li,.spaaza-receipt ul li{list-style-position:inside;margin-left:5px}.spaaza-receipt a{color:#348eda;text-decoration:underline}.spaaza-receipt .word-wrap,.spaaza-receipt code,.spaaza-receipt pre{word-break:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto}.spaaza-receipt .divider{border-collapse:separate}.spaaza-receipt .divider-spacer{padding:20px 0}.spaaza-receipt .divider td{border-top:1px solid #ccc;line-height:0;font-size:0;height:1px;margin:0;padding:0}.spaaza-receipt .last{margin-bottom:0}.spaaza-receipt .first{margin-top:0}.spaaza-receipt .align-center{text-align:center}.spaaza-receipt .align-right{text-align:right}.spaaza-receipt .align-left{text-align:left}.spaaza-receipt .clear{clear:both}.spaaza-receipt .mt0{margin-top:0}.spaaza-receipt .mb0{margin-bottom:0}.spaaza-receipt .preheader{color:transparent;display:none;height:0;max-height:0;max-width:0;opacity:0;overflow:hidden;mso-hide:all;visibility:hidden;width:0}@media only screen and (max-width:620px){.spaaza-receipt table[class=body] h1,.spaaza-receipt table[class=body] h2,.spaaza-receipt table[class=body] h3,.spaaza-receipt table[class=body] h4{font-weight:600!important}.spaaza-receipt table[class=body] h1{font-size:22px!important}.spaaza-receipt table[class=body] h2{font-size:18px!important}.spaaza-receipt table[class=body] h3{font-size:16px!important}.spaaza-receipt table[class=body] .content,.spaaza-receipt table[class=body] .wrapper{padding:10px!important}.spaaza-receipt table[class=body] .container{padding:0!important;width:100%!important}.spaaza-receipt table[class=body] .btn a,.spaaza-receipt table[class=body] .btn table{width:100%!important}}.spaaza-receipt .receipt-strong{font-weight:700;text-transform:uppercase}.spaaza-receipt .receipt-emphasys{font-style:italic}.spaaza-receipt .receipt-line-through{text-decoration:line-through}.spaaza-receipt table.receipt-lineitems td,.spaaza-receipt table.receipt-lineitems th,.spaaza-receipt table.receipt-linetaxes td,.spaaza-receipt table.receipt-linetaxes th{width:33%}.spaaza-receipt img.brand_logo{display:block;margin:3em auto;height:100px}.spaaza-receipt h1{text-align:center}.spaaza-receipt .receipt-original-price{display:none}.spaaza-receipt .receipt-original-price.receipt-line-through{display:inline}.spaaza-receipt .btn-download{width:100%;padding-bottom:15px;background-color:#348eda;border-radius:5px;text-align:center;font-family:"Helvetica Neue",Helvetica,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;font-size:14px;height:100%!important;line-height:1.6em;margin:0;padding:0;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}.spaaza-receipt .btn-download a{background-color:#348eda;border:solid 1px #348eda;border-radius:5px;color:#fff;cursor:pointer;display:inline-block;font-size:14px;font-weight:700;margin:0;padding:12px 25px;text-decoration:none;text-transform:capitalize}.spaaza-receipt .receipt-footer-message{text-align:center}.spaaza-receipt .barcode{padding:2em 0}.spaaza-receipt .barcode .image{background-position:center top;background-repeat:no-repeat;height:45px}';"loading"===document.readyState?document.addEventListener("readystatechange",function(){"loading"!==document.readyState&&(e(),n())}):(e(),n())}();
